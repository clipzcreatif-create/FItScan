<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FitScan - The Ultimate AI Fitness & Nutrition Ecosystem</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Alpine.js -->
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js" defer></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&family=Share+Tech+Mono&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        neon: '#39FF14',
                        dark: '#050505',
                        surface: '#121212',
                        primary: '#00C853'
                    },
                    fontFamily: {
                        sans: ['Montserrat', 'sans-serif'],
                        mono: ['Share Tech Mono', 'monospace'],
                    },
                    animation: {
                        'scan-vertical': 'scan 3s linear infinite',
                        'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'bounce-slight': 'bounce-slight 2s infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        'bounce-slight': {
                            '0%, 100%': { transform: 'translateY(-5%)', animationTimingFunction: 'cubic-bezier(0.8,0,1,1)' },
                            '50%': { transform: 'translateY(0)', animationTimingFunction: 'cubic-bezier(0,0,0.2,1)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #050505;
            color: #ffffff;
            -webkit-tap-highlight-color: transparent;
        }

        /* Neon Glow Effects */
        .text-glow { text-shadow: 0 0 10px rgba(57, 255, 20, 0.7); }
        .box-glow { box-shadow: 0 0 20px rgba(57, 255, 20, 0.2); }
        
        /* Grid Background Pattern */
        .bg-grid {
            background-size: 40px 40px;
            background-image: 
                linear-gradient(to right, rgba(57, 255, 20, 0.05) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(57, 255, 20, 0.05) 1px, transparent 1px);
        }

        /* Scanner Animation */
        @keyframes scan {
            0% { top: 0%; opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { top: 100%; opacity: 0; }
        }

        /* Checkmark Animation */
        @keyframes check-scale {
            0% { transform: scale(0); opacity: 0; }
            60% { transform: scale(1.2); }
            100% { transform: scale(1); opacity: 1; }
        }
        .animate-check { animation: check-scale 0.5s ease-out forwards; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: #111; }
        ::-webkit-scrollbar-thumb { background: #39FF14; border-radius: 2px; }

        .safe-bottom { padding-bottom: env(safe-area-inset-bottom); }
    </style>
</head>
<body class="antialiased overflow-x-hidden relative" 
      x-data="appData()" 
      x-init="initApp()">

    <!-- NAVBAR -->
    <nav class="fixed w-full z-40 transition-all duration-300"
         :class="scrolled ? 'bg-dark/90 backdrop-blur-md border-b border-white/10' : 'bg-transparent'">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16 md:h-20">
                <!-- Logo -->
                <div class="flex items-center gap-2 cursor-pointer" @click="window.scrollTo(0,0)">
                    <i class="fa-solid fa-dna text-neon text-2xl animate-pulse-fast"></i>
                    <span class="font-bold text-xl md:text-2xl tracking-tighter">FIT<span class="text-neon text-glow">SCAN</span></span>
                </div>

                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#about" class="hover:text-neon transition text-sm font-medium">Tentang Kami</a>
                    <a href="#features" class="hover:text-neon transition text-sm font-medium">Fitur AI</a>
                    <a href="#pricing" class="hover:text-neon transition text-sm font-medium">Harga</a>
                    
                    <!-- Auth State in Navbar -->
                    <template x-if="!isLoggedIn">
                        <button @click="openAuth('login')" class="bg-neon text-black font-bold px-5 py-2 rounded-full hover:bg-white transition hover:scale-105 shadow-[0_0_15px_rgba(57,255,20,0.4)] text-sm flex items-center gap-2">
                            <i class="fa-solid fa-user"></i> Login / Daftar
                        </button>
                    </template>
                    
                    <template x-if="isLoggedIn">
                        <div class="flex items-center gap-4">
                            <div class="text-right">
                                <p class="text-xs text-gray-400">Halo,</p>
                                <p class="text-sm font-bold text-white" x-text="currentUser.name"></p>
                            </div>
                            <div class="relative group cursor-pointer">
                                <div class="w-10 h-10 rounded-full bg-gray-800 border-2 flex items-center justify-center overflow-hidden"
                                     :class="currentUser.tier === 'Premium' ? 'border-neon' : 'border-gray-500'">
                                    <i class="fa-solid fa-user text-gray-400"></i>
                                </div>
                                <!-- Badge Tier -->
                                <div class="absolute -bottom-1 -right-1 px-1.5 py-0.5 rounded text-[8px] font-bold uppercase tracking-wider"
                                     :class="currentUser.tier === 'Premium' ? 'bg-neon text-black' : 'bg-gray-600 text-white'">
                                    <span x-text="currentUser.tier === 'Premium' ? 'PRO' : 'FREE'"></span>
                                </div>
                                
                                <!-- Dropdown Logout -->
                                <div class="absolute right-0 mt-2 w-48 bg-dark border border-gray-700 rounded-xl shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform origin-top-right z-50">
                                    <div class="p-3 border-b border-gray-800">
                                        <p class="text-xs text-gray-500">Status Akun</p>
                                        <p class="text-sm font-bold" :class="currentUser.tier === 'Premium' ? 'text-neon' : 'text-white'" x-text="currentUser.tier"></p>
                                    </div>
                                    <button @click="logout()" class="w-full text-left px-4 py-3 text-sm text-red-400 hover:bg-gray-900 rounded-b-xl">
                                        <i class="fa-solid fa-right-from-bracket mr-2"></i> Logout
                                    </button>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>

                <!-- Mobile Menu Button -->
                <button @click="mobileMenu = !mobileMenu" class="md:hidden text-white p-2 focus:outline-none">
                    <i class="fa-solid text-xl" :class="mobileMenu ? 'fa-xmark' : 'fa-bars'"></i>
                </button>
            </div>
        </div>

        <!-- Mobile Menu Dropdown -->
        <div x-show="mobileMenu" 
             x-transition 
             class="md:hidden bg-dark/95 backdrop-blur-xl border-b border-gray-800 absolute w-full left-0 shadow-2xl z-50">
            <div class="px-4 py-6 space-y-4">
                <!-- Mobile Auth Info -->
                <div x-show="isLoggedIn" class="bg-gray-800/50 p-4 rounded-xl border border-gray-700 mb-4 flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center">
                        <i class="fa-solid fa-user text-white"></i>
                    </div>
                    <div>
                        <p class="font-bold text-white" x-text="currentUser?.name"></p>
                        <span class="text-xs px-2 py-0.5 rounded" :class="currentUser?.tier === 'Premium' ? 'bg-neon text-black' : 'bg-gray-600 text-white'" x-text="currentUser?.tier"></span>
                    </div>
                </div>

                <a href="#about" @click="mobileMenu = false" class="block text-base font-medium text-gray-300 hover:text-neon">Tentang Kami</a>
                <a href="#features" @click="mobileMenu = false" class="block text-base font-medium text-gray-300 hover:text-neon">Fitur AI</a>
                <a href="#pricing" @click="mobileMenu = false" class="block text-base font-medium text-gray-300 hover:text-neon">Harga & Paket</a>
                
                <div x-show="!isLoggedIn">
                    <button @click="mobileMenu = false; openAuth('login')" class="w-full bg-neon text-black font-bold py-3 rounded-xl mt-2">
                        Login / Daftar
                    </button>
                </div>
                
                <div x-show="isLoggedIn">
                    <button @click="logout()" class="w-full border border-red-500 text-red-500 font-bold py-3 rounded-xl mt-2 hover:bg-red-500 hover:text-white transition">
                        Logout
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- HERO SECTION -->
    <section class="relative min-h-[100dvh] flex items-center justify-center overflow-hidden pt-16">
        <div class="absolute inset-0 bg-dark">
            <div class="absolute inset-0 bg-grid opacity-30"></div>
            <div class="absolute inset-0 bg-gradient-to-t from-dark via-transparent to-dark"></div>
            <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[80vw] h-[80vw] bg-neon/5 blur-[100px] rounded-full pointer-events-none"></div>
        </div>

        <div class="relative z-10 container mx-auto px-4 text-center">
            <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full border border-neon/30 bg-neon/5 mb-6 backdrop-blur-sm animate-float">
                <span class="w-2 h-2 rounded-full bg-neon animate-pulse"></span>
                <span class="text-neon text-xs md:text-sm font-mono tracking-widest uppercase">Revolutionizing Fitness with AI</span>
            </div>
            
            <h1 class="text-4xl md:text-6xl lg:text-7xl font-extrabold mb-6 leading-tight tracking-tight">
                The Ultimate AI <br>
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-neon to-green-500 text-glow">Fitness Ecosystem</span>
            </h1>
            
            <p class="text-gray-400 text-lg md:text-xl max-w-2xl mx-auto mb-10 leading-relaxed">
                Gabungan <strong>AI Food Recognition</strong> dan <strong>Motion Analysis</strong> dalam satu aplikasi. Capai body goal (Cutting/Bulking) lebih cepat dan aman.
            </p>

            <div class="flex flex-col sm:flex-row gap-4 justify-center items-center w-full max-w-md mx-auto sm:max-w-none">
                <button @click="startScan('body')" class="w-full sm:w-auto bg-neon text-black font-extrabold px-8 py-4 rounded-xl text-lg hover:bg-white transition transform hover:-translate-y-1 box-glow flex items-center justify-center gap-2">
                    <i class="fa-solid fa-camera"></i> AI Motion Scan
                </button>
                <button @click="startScan('food')" class="w-full sm:w-auto border border-gray-700 bg-white/5 backdrop-blur text-white font-semibold px-8 py-4 rounded-xl text-lg hover:border-neon hover:text-neon transition flex items-center justify-center gap-2">
                    <i class="fa-solid fa-bowl-food"></i> AI Food Scan
                </button>
            </div>
            
            <div class="mt-8">
                <p x-show="!isLoggedIn" class="text-xs text-gray-500 animate-pulse">
                    <i class="fa-solid fa-lock mr-1"></i> Login diperlukan untuk akses fitur
                </p>
                <p x-show="isLoggedIn" class="text-xs text-neon font-bold">
                    <i class="fa-solid fa-unlock mr-1"></i> Akses diberikan: <span x-text="currentUser?.tier"></span>
                </p>
            </div>
        </div>
    </section>

    <!-- AUTH MODAL -->
    <div x-show="showAuthModal" 
         x-transition.opacity
         class="fixed inset-0 z-[150] bg-black/95 backdrop-blur-md flex items-center justify-center p-4">
        
        <div class="bg-surface w-full max-w-md rounded-3xl border border-gray-800 shadow-2xl relative overflow-hidden" @click.away="showAuthModal = false">
            <button @click="showAuthModal = false" class="absolute top-4 right-4 text-gray-400 hover:text-white">
                <i class="fa-solid fa-xmark text-xl"></i>
            </button>

            <!-- Login View -->
            <div x-show="authMode === 'login'" class="p-8">
                <div class="text-center mb-8">
                    <i class="fa-solid fa-user-circle text-5xl text-neon mb-4"></i>
                    <h3 class="text-2xl font-bold text-white">Selamat Datang</h3>
                    <p class="text-gray-400 text-sm">Masuk untuk melanjutkan ke FitScan</p>
                </div>
                
                <form @submit.prevent="login()" class="space-y-4">
                    <div>
                        <label class="block text-xs text-gray-500 mb-1">Email</label>
                        <input type="email" x-model="loginEmail" required class="w-full bg-black border border-gray-700 rounded-xl px-4 py-3 text-white focus:border-neon focus:outline-none transition">
                    </div>
                    <div>
                        <label class="block text-xs text-gray-500 mb-1">Password</label>
                        <input type="password" x-model="loginPass" required class="w-full bg-black border border-gray-700 rounded-xl px-4 py-3 text-white focus:border-neon focus:outline-none transition">
                    </div>
                    <button type="submit" class="w-full bg-neon text-black font-bold py-3 rounded-xl hover:bg-white transition shadow-lg shadow-neon/20">
                        Masuk
                    </button>
                </form>

                <p class="text-center text-sm text-gray-500 mt-6">
                    Belum punya akun? <a href="#" @click.prevent="authMode = 'register'" class="text-neon hover:underline">Daftar Sekarang</a>
                </p>
            </div>

            <!-- Register View -->
            <div x-show="authMode === 'register'" class="p-8">
                <div class="text-center mb-8">
                    <i class="fa-solid fa-user-plus text-5xl text-neon mb-4"></i>
                    <h3 class="text-2xl font-bold text-white">Buat Akun</h3>
                    <p class="text-gray-400 text-sm">Mulai perjalanan sehatmu hari ini</p>
                </div>
                
                <form @submit.prevent="register()" class="space-y-4">
                    <div>
                        <label class="block text-xs text-gray-500 mb-1">Nama Lengkap</label>
                        <input type="text" x-model="regName" required class="w-full bg-black border border-gray-700 rounded-xl px-4 py-3 text-white focus:border-neon focus:outline-none transition">
                    </div>
                    <div>
                        <label class="block text-xs text-gray-500 mb-1">Email</label>
                        <input type="email" x-model="regEmail" required class="w-full bg-black border border-gray-700 rounded-xl px-4 py-3 text-white focus:border-neon focus:outline-none transition">
                    </div>
                    <div>
                        <label class="block text-xs text-gray-500 mb-1">Password</label>
                        <input type="password" x-model="regPass" required class="w-full bg-black border border-gray-700 rounded-xl px-4 py-3 text-white focus:border-neon focus:outline-none transition">
                    </div>
                    <button type="submit" class="w-full bg-neon text-black font-bold py-3 rounded-xl hover:bg-white transition shadow-lg shadow-neon/20">
                        Daftar Gratis
                    </button>
                </form>

                <p class="text-center text-sm text-gray-500 mt-6">
                    Sudah punya akun? <a href="#" @click.prevent="authMode = 'login'" class="text-neon hover:underline">Login disini</a>
                </p>
            </div>

        </div>
    </div>

    <!-- PROBLEM & SOLUTION (Why Now) -->
    <section id="about" class="py-20 bg-surface border-t border-white/5">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                <div>
                    <h2 class="text-3xl font-bold mb-6">Mengapa <span class="text-neon">FitScan?</span></h2>
                    <div class="space-y-6">
                        <div class="bg-dark p-6 rounded-2xl border border-red-900/30 relative overflow-hidden">
                            <div class="absolute right-0 top-0 p-4 opacity-10"><i class="fa-solid fa-triangle-exclamation text-6xl text-red-500"></i></div>
                            <h3 class="text-xl font-bold text-red-500 mb-2">Masalah Umum</h3>
                            <ul class="space-y-3 text-gray-400 text-sm">
                                <li class="flex items-start"><i class="fa-solid fa-xmark text-red-500 mt-1 mr-3"></i> 60% Member Gym berhenti di 3 bulan pertama.</li>
                                <li class="flex items-start"><i class="fa-solid fa-xmark text-red-500 mt-1 mr-3"></i> Salah hitung kalori & nutrisi harian.</li>
                                <li class="flex items-start"><i class="fa-solid fa-xmark text-red-500 mt-1 mr-3"></i> Form latihan keliru menyebabkan cedera.</li>
                            </ul>
                        </div>
                        
                        <div class="bg-dark p-6 rounded-2xl border border-neon/30 relative overflow-hidden">
                            <div class="absolute right-0 top-0 p-4 opacity-10"><i class="fa-solid fa-check-circle text-6xl text-neon"></i></div>
                            <h3 class="text-xl font-bold text-neon mb-2">Solusi FitScan</h3>
                            <ul class="space-y-3 text-gray-300 text-sm">
                                <li class="flex items-start"><i class="fa-solid fa-check text-neon mt-1 mr-3"></i> Ekosistem All-in-One (Food + Motion).</li>
                                <li class="flex items-start"><i class="fa-solid fa-check text-neon mt-1 mr-3"></i> Virtual PT dengan Computer Vision real-time.</li>
                                <li class="flex items-start"><i class="fa-solid fa-check text-neon mt-1 mr-3"></i> Roadmap personal (Cutting/Bulking/Recomp).</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="relative">
                    <div class="absolute inset-0 bg-neon/10 blur-3xl rounded-full"></div>
                    <div class="relative bg-dark border border-gray-800 rounded-3xl p-6 shadow-2xl">
                        <!-- Simulated Chart -->
                        <div class="flex justify-between items-end mb-4">
                            <div>
                                <p class="text-sm text-gray-500">Market Gap</p>
                                <p class="text-2xl font-bold text-white">High Demand</p>
                            </div>
                            <div class="text-right">
                                <p class="text-sm text-gray-500">Growth (SEA)</p>
                                <p class="text-2xl font-bold text-neon">+40%</p>
                            </div>
                        </div>
                        <div class="h-40 flex items-end justify-between gap-2">
                            <div class="w-full bg-gray-800 rounded-t-lg h-[40%]"></div>
                            <div class="w-full bg-gray-800 rounded-t-lg h-[55%]"></div>
                            <div class="w-full bg-gray-800 rounded-t-lg h-[70%]"></div>
                            <div class="w-full bg-neon rounded-t-lg h-[100%] box-glow relative group">
                                <div class="absolute -top-8 left-1/2 -translate-x-1/2 bg-white text-black text-xs font-bold px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition">Now</div>
                            </div>
                        </div>
                        <p class="mt-4 text-xs text-center text-gray-500 font-mono">Pertumbuhan Pengguna Aplikasi Kesehatan di Asia Tenggara</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FEATURES SECTION -->
    <section id="features" class="py-20 bg-dark relative">
        <div class="absolute inset-0 bg-grid opacity-20 pointer-events-none"></div>
        <div class="container mx-auto px-4 relative z-10">
            <div class="text-center mb-16">
                <span class="text-neon text-sm font-bold tracking-widest uppercase">Core Technology</span>
                <h2 class="text-3xl md:text-5xl font-bold mt-2">Dua AI dalam <span class="text-white bg-neon/10 px-2 rounded">Satu Aplikasi</span></h2>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- AI Food -->
                <div class="bg-surface p-8 rounded-3xl border border-white/5 hover:border-neon/50 transition duration-300 group hover:-translate-y-2">
                    <div class="w-14 h-14 bg-gray-900 rounded-2xl flex items-center justify-center mb-6 border border-gray-700 group-hover:border-neon group-hover:bg-neon/10">
                        <i class="fa-solid fa-utensils text-neon text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-white mb-3">AI Food Recognition</h3>
                    <p class="text-gray-400 text-sm leading-relaxed">Hitung makro & kalori otomatis hanya dari foto makanan. Akurasi tinggi untuk masakan lokal maupun internasional.</p>
                </div>

                <!-- AI Motion -->
                <div class="bg-surface p-8 rounded-3xl border border-white/5 hover:border-neon/50 transition duration-300 group hover:-translate-y-2">
                    <div class="w-14 h-14 bg-gray-900 rounded-2xl flex items-center justify-center mb-6 border border-gray-700 group-hover:border-neon group-hover:bg-neon/10">
                        <i class="fa-solid fa-person-running text-neon text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-white mb-3">AI Motion Analysis</h3>
                    <p class="text-gray-400 text-sm leading-relaxed">Koreksi form latihan real-time untuk mencegah cedera. Bertindak sebagai "Virtual PT" pribadi Anda di gym atau rumah.</p>
                </div>

                <!-- Roadmap -->
                <div class="bg-surface p-8 rounded-3xl border border-white/5 hover:border-neon/50 transition duration-300 group hover:-translate-y-2">
                    <div class="w-14 h-14 bg-gray-900 rounded-2xl flex items-center justify-center mb-6 border border-gray-700 group-hover:border-neon group-hover:bg-neon/10">
                        <i class="fa-solid fa-map-location-dot text-neon text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-white mb-3">Personalized Roadmap</h3>
                    <p class="text-gray-400 text-sm leading-relaxed">Rekomendasi program latihan dan nutrisi yang disesuaikan dengan tujuan spesifik: Cutting, Bulking, atau Recomp.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- PRICING -->
    <section id="pricing" class="py-20 bg-surface border-y border-white/5">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold">Pilih Paket Anda</h2>
                <p class="text-gray-400 mt-2">Investasi terbaik untuk kesehatan jangka panjang.</p>
            </div>

            <div class="flex flex-col md:flex-row justify-center gap-6 max-w-4xl mx-auto">
                <!-- Freemium -->
                <div class="flex-1 bg-dark p-8 rounded-3xl border border-gray-800 opacity-80 hover:opacity-100 transition relative">
                    <!-- Current Plan Badge -->
                    <div x-show="isLoggedIn && currentUser?.tier === 'Free'" class="absolute -top-3 left-1/2 -translate-x-1/2 bg-gray-600 text-white text-xs px-3 py-1 rounded-full font-bold shadow-lg">PLAN SAAT INI</div>
                    
                    <h3 class="text-xl font-bold text-white mb-2">Freemium</h3>
                    <p class="text-4xl font-bold text-white mb-6">Rp 0</p>
                    <ul class="space-y-4 mb-8 text-sm text-gray-400">
                        <li class="flex items-center"><i class="fa-solid fa-check text-gray-500 mr-2"></i> Akses Fitur Dasar</li>
                        <li class="flex items-center"><i class="fa-solid fa-check text-gray-500 mr-2"></i> Pencatatan Manual</li>
                        <li class="flex items-center"><i class="fa-solid fa-check text-gray-500 mr-2"></i> Komunitas Umum</li>
                    </ul>
                    <button class="w-full py-3 rounded-xl border border-gray-600 text-white font-bold cursor-not-allowed opacity-50">Gratis Selamanya</button>
                </div>

                <!-- Subscription -->
                <div class="flex-1 bg-gray-900 p-8 rounded-3xl border border-neon relative transform md:-translate-y-4 shadow-[0_0_30px_rgba(57,255,20,0.1)]">
                    <!-- Current Plan Badge -->
                    <div x-show="isLoggedIn && currentUser?.tier === 'Premium'" class="absolute -top-3 left-1/2 -translate-x-1/2 bg-neon text-black text-xs px-3 py-1 rounded-full font-bold shadow-lg z-20">AKTIF - PLAN SAAT INI</div>

                    <div class="absolute top-0 right-0 bg-neon text-black text-xs font-bold px-3 py-1 rounded-bl-xl rounded-tr-xl">POPULAR</div>
                    <h3 class="text-xl font-bold text-white mb-2">Full Access</h3>
                    <p class="text-4xl font-bold text-white mb-1">Rp 79.000<span class="text-sm font-normal text-gray-400">/bln</span></p>
                    <p class="text-xs text-neon mb-6">Setara harga 2x kopi kekinian</p>
                    <ul class="space-y-4 mb-8 text-sm text-gray-300">
                        <li class="flex items-center"><i class="fa-solid fa-check text-neon mr-2"></i> <strong>AI Motion Analysis</strong> Unlimited</li>
                        <li class="flex items-center"><i class="fa-solid fa-check text-neon mr-2"></i> <strong>AI Food Recognition</strong></li>
                        <li class="flex items-center"><i class="fa-solid fa-check text-neon mr-2"></i> Personalized Meal Plan</li>
                    </ul>
                    <button @click="startPayment()" 
                            class="w-full py-3 rounded-xl font-bold transition shadow-lg shadow-neon/20"
                            :class="isLoggedIn && currentUser?.tier === 'Premium' ? 'bg-gray-700 text-gray-400 cursor-not-allowed' : 'bg-neon text-black hover:bg-white'"
                            :disabled="isLoggedIn && currentUser?.tier === 'Premium'">
                        <span x-text="isLoggedIn && currentUser?.tier === 'Premium' ? 'Sudah Aktif' : 'Mulai Langganan'"></span>
                    </button>
                </div>

                <!-- B2B -->
                <div class="flex-1 bg-dark p-8 rounded-3xl border border-gray-800 opacity-80 hover:opacity-100 transition">
                    <h3 class="text-xl font-bold text-white mb-2">FitScan Pro</h3>
                    <p class="text-lg font-bold text-white mb-6">B2B Partner</p>
                    <ul class="space-y-4 mb-8 text-sm text-gray-400">
                        <li class="flex items-center"><i class="fa-solid fa-check text-blue-400 mr-2"></i> Dashboard Monitoring Klien</li>
                        <li class="flex items-center"><i class="fa-solid fa-check text-blue-400 mr-2"></i> Untuk Personal Trainer</li>
                        <li class="flex items-center"><i class="fa-solid fa-check text-blue-400 mr-2"></i> Untuk Gym Owner</li>
                    </ul>
                    <button @click="contactSales()" class="w-full py-3 rounded-xl border border-blue-400 text-blue-400 font-bold hover:bg-blue-400 hover:text-black transition">Hubungi Sales</button>
                </div>
            </div>
        </div>
    </section>

    <!-- TEAM -->
    <section class="py-20 bg-dark border-t border-white/5 text-center">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold mb-10">Leadership Team</h2>
            <div class="inline-block bg-surface p-6 rounded-3xl border border-gray-800 hover:border-neon transition duration-300">
                <div class="w-24 h-24 bg-gray-800 rounded-full mx-auto mb-4 overflow-hidden border-2 border-neon">
                    <!-- Placeholder Avatar -->
                    <img src="https://ui-avatars.com/api/?name=Rafael+Sanjales&background=39FF14&color=000" alt="Rafael" class="w-full h-full object-cover">
                </div>
                <h3 class="text-xl font-bold text-white">Rafael Sanjales T.L.</h3>
                <p class="text-neon text-xs font-bold tracking-widest uppercase mt-1">CEO & Founder</p>
                <p class="text-gray-400 text-sm mt-4 max-w-xs mx-auto">Visioner di balik ekosistem FitScan, memimpin strategi jangka panjang dan kemitraan.</p>
            </div>
        </div>
    </section>

    <!-- SCANNER MODAL (Updated for Dual Mode) -->
    <div x-show="isScanning" 
         x-transition.opacity.duration.300ms
         class="fixed inset-0 z-[100] bg-black flex flex-col safe-bottom">
        
        <!-- Video Container -->
        <div class="relative flex-1 w-full overflow-hidden bg-gray-900">
            <video x-ref="video" class="absolute inset-0 w-full h-full object-cover transform scale-x-[-1]" playsinline autoplay muted></video>
            
            <!-- Simulation Overlays -->
            <div x-show="cameraError" class="absolute inset-0 flex items-center justify-center bg-gray-900">
                <div class="absolute inset-0 bg-grid opacity-20"></div>
                <p class="text-gray-500">Mode Simulasi Aktif</p>
            </div>

            <!-- HUD Overlay -->
            <div class="absolute inset-0 pointer-events-none p-6 flex flex-col justify-between">
                <!-- Top HUD -->
                <div class="flex justify-between items-start pointer-events-auto">
                    <div class="text-xs font-mono text-neon/80">
                        <p>MODE: <span class="text-white font-bold" x-text="scanMode === 'food' ? 'FOOD RECOGNITION' : 'MOTION ANALYSIS'"></span></p>
                        <p class="mt-1"><span class="animate-pulse text-red-500">●</span> LIVE AI PROCESSING</p>
                    </div>
                    <button @click="stopScan()" class="bg-black/40 backdrop-blur border border-white/20 p-2 rounded-full text-white hover:text-red-500 transition">
                        <i class="fa-solid fa-xmark text-xl w-6 h-6 flex items-center justify-center"></i>
                    </button>
                </div>

                <!-- Center Scanner Box -->
                <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[70vw] h-[45vh] max-w-[400px] border-2 border-neon/30 rounded-2xl overflow-hidden box-glow transition-all duration-500"
                     :class="scanMode === 'food' ? 'h-[35vh] rounded-xl' : 'h-[50vh]'">
                    <!-- Corners -->
                    <div class="absolute top-0 left-0 w-6 h-6 border-t-4 border-l-4 border-neon"></div>
                    <div class="absolute top-0 right-0 w-6 h-6 border-t-4 border-r-4 border-neon"></div>
                    <div class="absolute bottom-0 left-0 w-6 h-6 border-b-4 border-l-4 border-neon"></div>
                    <div class="absolute bottom-0 right-0 w-6 h-6 border-b-4 border-r-4 border-neon"></div>
                    
                    <!-- Scan Line -->
                    <div class="absolute w-full h-1 bg-neon shadow-[0_0_15px_#39FF14] animate-scan-vertical"></div>
                    
                    <!-- Target Icon -->
                    <div class="absolute inset-0 flex items-center justify-center opacity-50">
                        <i class="fa-solid text-4xl text-neon" :class="scanMode === 'food' ? 'fa-utensils' : 'fa-person-running'"></i>
                    </div>
                </div>

                <!-- Bottom Status -->
                <div class="text-center mb-8">
                    <div class="inline-block bg-black/60 backdrop-blur border border-neon/50 px-6 py-2 rounded-full">
                        <i class="fa-solid fa-circle-notch fa-spin text-neon mr-2"></i>
                        <span class="font-mono text-neon text-sm uppercase tracking-widest" x-text="scanStatus">INITIALIZING...</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- RESULT MODAL -->
    <div x-show="showResults" 
         x-transition.opacity
         class="fixed inset-0 z-[110] bg-black/90 backdrop-blur-sm flex items-end md:items-center justify-center p-0 md:p-4">
        
        <div class="bg-surface w-full md:max-w-md md:rounded-3xl rounded-t-3xl border-t md:border border-white/10 shadow-2xl overflow-hidden flex flex-col max-h-[85vh]">
            <div class="p-4 border-b border-white/5 flex justify-between items-center bg-dark/50">
                <h3 class="font-bold text-lg text-white">
                    <i class="fa-solid mr-2 text-neon" :class="scanMode === 'food' ? 'fa-bowl-food' : 'fa-clipboard-check'"></i>
                    <span x-text="scanMode === 'food' ? 'Nutrisi Makanan' : 'Analisis Tubuh'"></span>
                </h3>
                <button @click="closeResults()" class="text-gray-400 hover:text-white bg-white/5 p-2 rounded-full">
                    <i class="fa-solid fa-xmark"></i>
                </button>
            </div>

            <div class="p-6 overflow-y-auto custom-scrollbar">
                
                <!-- Food Result -->
                <div x-show="scanMode === 'food'">
                    <div class="text-center mb-6">
                        <div class="inline-block p-3 rounded-full bg-orange-500/20 text-orange-400 mb-2 border border-orange-500/50">
                            <i class="fa-solid fa-burger text-2xl"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-white" x-text="currentFoodResult.name"></h2>
                        <p class="text-gray-400 text-sm">Akurasi AI: <span x-text="currentFoodResult.score"></span>%</p>
                    </div>
                    <div class="grid grid-cols-2 gap-3 mb-4">
                        <div class="bg-dark p-3 rounded-xl border border-white/10 text-center">
                            <p class="text-xs text-gray-500">Kalori</p>
                            <p class="text-xl font-bold text-white"><span x-text="currentFoodResult.cal"></span> <span class="text-xs text-neon">kcal</span></p>
                        </div>
                        <div class="bg-dark p-3 rounded-xl border border-white/10 text-center">
                            <p class="text-xs text-gray-500">Protein</p>
                            <p class="text-xl font-bold text-white"><span x-text="currentFoodResult.protein"></span> <span class="text-xs text-neon">g</span></p>
                        </div>
                    </div>
                    <div class="bg-blue-900/20 p-4 rounded-xl border border-blue-500/30 text-sm text-blue-200">
                        <i class="fa-solid fa-circle-info mr-2"></i> Cocok untuk program <strong x-text="currentFoodResult.type"></strong> Anda.
                    </div>
                </div>

                <!-- Body Result -->
                <div x-show="scanMode === 'body'">
                    <div class="mb-4 text-center" x-show="isReturningUser">
                        <span class="inline-block px-3 py-1 bg-neon/10 border border-neon rounded-full text-xs text-neon font-bold uppercase tracking-wider">
                            <i class="fa-solid fa-face-smile mr-1"></i> Wajah Dikenali
                        </span>
                    </div>

                    <div class="flex flex-col items-center justify-center mb-6">
                         <div class="w-32 h-32 rounded-full border-4 border-gray-800 flex items-center justify-center relative">
                            <!-- Animated Ring -->
                            <div class="absolute inset-0 rounded-full border-4 border-neon border-t-transparent animate-spin" style="animation-duration: 3s"></div>
                            <div class="text-center">
                                <span class="text-4xl font-bold text-white" x-text="currentBodyResult.score"></span>
                                <p class="text-[10px] text-gray-400 uppercase">Fit Score</p>
                            </div>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center bg-dark p-3 rounded-xl border border-white/10">
                            <span class="text-gray-400 text-sm">Body Fat</span>
                            <span class="font-bold text-white"><span x-text="currentBodyResult.fat"></span>%</span>
                        </div>
                        <div class="flex justify-between items-center bg-dark p-3 rounded-xl border border-white/10">
                            <span class="text-gray-400 text-sm">Muscle Mass</span>
                            <span class="font-bold text-white"><span x-text="currentBodyResult.muscle"></span> kg</span>
                        </div>
                    </div>
                </div>

            </div>

            <div class="p-4 bg-dark border-t border-white/10 flex flex-col gap-3 safe-bottom">
                <button @click="startScan(scanMode)" class="w-full bg-neon text-black font-bold py-3 rounded-xl hover:bg-white transition text-sm shadow-neon/50 shadow-lg">
                    <i class="fa-solid fa-rotate-right mr-2"></i> Scan Ulang
                </button>
                
                <!-- Reset Button (Only for Body Scan) -->
                <button x-show="scanMode === 'body'" @click="resetBodyData()" class="w-full bg-gray-800 text-gray-400 font-bold py-3 rounded-xl hover:text-white hover:bg-gray-700 transition text-sm border border-gray-700">
                    <i class="fa-solid fa-user-plus mr-2"></i> Scan Orang Lain
                </button>
            </div>
        </div>
    </div>

    <!-- PAYMENT MODAL -->
    <div x-show="showPaymentModal" 
         x-transition.opacity
         class="fixed inset-0 z-[120] bg-black/95 backdrop-blur-md flex items-end md:items-center justify-center p-0 md:p-4">
        
        <div class="bg-surface w-full md:max-w-md md:rounded-3xl rounded-t-3xl border-t md:border border-white/10 shadow-2xl overflow-hidden flex flex-col max-h-[85vh] relative">
            <button @click="closePayment()" class="absolute top-4 right-4 text-gray-400 hover:text-white z-20">
                <i class="fa-solid fa-xmark text-xl"></i>
            </button>

            <!-- STEP 1: Method -->
            <div x-show="paymentStep === 1" class="p-6 md:p-8 flex flex-col h-full">
                <h3 class="text-2xl font-bold text-white mb-2">Metode Pembayaran</h3>
                <p class="text-gray-400 text-sm mb-6">Pilih cara pembayaran yang nyaman untuk Anda.</p>
                
                <div class="space-y-3 flex-1">
                    <button @click="paymentStep = 2" class="w-full bg-dark p-4 rounded-xl border border-gray-700 hover:border-neon transition flex items-center justify-between group">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 bg-white rounded-lg flex items-center justify-center text-blue-600 font-bold text-xs">BCA</div>
                            <div class="text-left">
                                <p class="font-bold text-white group-hover:text-neon">Transfer Bank BCA</p>
                                <p class="text-xs text-gray-500">Otomatis dicek</p>
                            </div>
                        </div>
                        <i class="fa-solid fa-chevron-right text-gray-600 group-hover:text-neon"></i>
                    </button>
                    <button @click="paymentStep = 2" class="w-full bg-dark p-4 rounded-xl border border-gray-700 hover:border-neon transition flex items-center justify-between group">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 bg-blue-800 rounded-lg flex items-center justify-center text-white font-bold text-xs">MDR</div>
                            <div class="text-left">
                                <p class="font-bold text-white group-hover:text-neon">Mandiri Virtual</p>
                                <p class="text-xs text-gray-500">Otomatis dicek</p>
                            </div>
                        </div>
                        <i class="fa-solid fa-chevron-right text-gray-600 group-hover:text-neon"></i>
                    </button>
                </div>
            </div>

            <!-- STEP 2: Transfer Details -->
            <div x-show="paymentStep === 2" class="p-6 md:p-8 flex flex-col h-full">
                <div class="text-center mb-6">
                    <p class="text-gray-400 text-sm">Total Pembayaran</p>
                    <h3 class="text-3xl font-bold text-neon mb-1">Rp 79.000</h3>
                    <div class="inline-block px-2 py-0.5 bg-red-500/20 text-red-400 text-[10px] rounded font-mono">BERAKHIR DLM 14:59</div>
                </div>

                <div class="bg-dark p-4 rounded-xl border border-dashed border-gray-700 mb-6">
                    <p class="text-xs text-gray-500 mb-1">Nomor Virtual Account</p>
                    <div class="flex justify-between items-center">
                        <p class="font-mono text-xl font-bold text-white tracking-wider">8801 9384 1928</p>
                        <button class="text-neon text-sm font-bold hover:text-white">SALIN</button>
                    </div>
                </div>

                <ul class="text-xs text-gray-400 space-y-2 mb-8 list-disc pl-4">
                    <li>Transfer sesuai nominal hingga 3 digit terakhir.</li>
                    <li>Simpan bukti transfer jika diperlukan.</li>
                    <li>Proses verifikasi membutuhkan waktu 1-5 menit.</li>
                </ul>

                <button @click="processPayment()" class="w-full bg-neon text-black font-bold py-3 rounded-xl hover:bg-white transition shadow-neon/20 shadow-lg">
                    Saya Sudah Transfer
                </button>
            </div>

            <!-- STEP 3: Processing -->
            <div x-show="paymentStep === 3" class="p-6 md:p-8 flex flex-col h-full items-center justify-center text-center">
                <div class="w-20 h-20 border-4 border-gray-800 border-t-neon rounded-full animate-spin mb-6"></div>
                <h3 class="text-xl font-bold text-white mb-2">Memverifikasi...</h3>
                <p class="text-gray-400 text-sm">Mohon tunggu sebentar, sistem sedang mengecek mutasi bank Anda.</p>
            </div>

            <!-- STEP 4: Success -->
            <div x-show="paymentStep === 4" class="p-6 md:p-8 flex flex-col h-full items-center justify-center text-center relative overflow-hidden">
                <div class="absolute inset-0 bg-neon/5"></div>
                
                <div class="w-24 h-24 bg-neon rounded-full flex items-center justify-center mb-6 shadow-[0_0_50px_rgba(57,255,20,0.5)] animate-check">
                    <i class="fa-solid fa-check text-4xl text-black"></i>
                </div>
                
                <h3 class="text-2xl font-bold text-white mb-2 animate-bounce-slight">Pembayaran Berhasil!</h3>
                <p class="text-gray-300 text-sm mb-8">Paket <strong class="text-neon">Full Access</strong> Anda telah aktif selama 30 hari.</p>
                
                <button @click="closePayment()" class="w-full bg-gray-800 text-white font-bold py-3 rounded-xl border border-gray-600 hover:bg-gray-700 transition">
                    Kembali ke Beranda
                </button>
            </div>

        </div>
    </div>

    <!-- FOOTER -->
    <footer class="bg-black py-12 border-t border-white/10">
        <div class="container mx-auto px-4 text-center">
            <div class="flex justify-center items-center gap-2 mb-6">
                <i class="fa-solid fa-dna text-neon text-xl"></i>
                <span class="font-bold text-xl text-white">FIT<span class="text-neon">SCAN</span></span>
            </div>
            <p class="text-gray-500 text-sm mb-8 max-w-md mx-auto">Kami membantu Anda mencapai tujuan kebugaran dengan teknologi AI yang presisi. Bergabunglah dengan revolusi kesehatan ini.</p>
            
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-400 mb-10">
                <a href="#" class="hover:text-neon">Kebijakan Privasi</a>
                <a href="#" class="hover:text-neon">Syarat & Ketentuan</a>
                <a href="#" class="hover:text-neon">Hubungi Kami</a>
                <a href="#" class="hover:text-neon">Investor Relations</a>
            </div>

            <p class="text-gray-700 text-xs">© 2024 FitScan AI Ecosystem. Kelompok 13 Binus University Malang.</p>
        </div>
    </footer>

    <!-- LOGIC SCRIPT -->
    <script>
        function appData() {
            return {
                scrolled: false,
                mobileMenu: false,
                isScanning: false,
                showResults: false,
                showPaymentModal: false,
                showAuthModal: false,
                authMode: 'login', // 'login' or 'register'
                paymentStep: 1,
                cameraError: false,
                scanStatus: 'INIT',
                scanMode: 'body', 
                stream: null,
                
                // User & Auth State
                isLoggedIn: false,
                isReturningUser: false,
                currentUser: null, // { name: '', email: '', tier: 'Free' }
                
                // Form Models
                loginEmail: '',
                loginPass: '',
                regName: '',
                regEmail: '',
                regPass: '',

                // Data Holders
                currentFoodResult: { name: '-', cal: 0, protein: 0, score: 0, type: '-' },
                currentBodyResult: { score: 0, fat: 0, muscle: 0 },

                // Food Database (Simulasi AI)
                foodDatabase: [
                    { name: "Nasi Ayam Bakar", cal: 540, protein: 32, score: 96, type: "Bulking" },
                    { name: "Gado-Gado", cal: 320, protein: 12, score: 92, type: "Cutting" },
                    { name: "Sate Ayam (10 Tusuk)", cal: 450, protein: 38, score: 94, type: "High Protein" },
                    { name: "Nasi Padang Rendang", cal: 720, protein: 28, score: 98, type: "Bulking" },
                    { name: "Salmon Steak & Veg", cal: 400, protein: 40, score: 99, type: "Cutting" }
                ],

                initApp() {
                    window.addEventListener('scroll', () => {
                        this.scrolled = window.scrollY > 20;
                    });
                    
                    // Cek LocalStorage untuk User Session
                    const savedUser = localStorage.getItem('fitscan_user');
                    if (savedUser) {
                        this.currentUser = JSON.parse(savedUser);
                        this.isLoggedIn = true;
                    }

                    // Cek data scan sebelumnya
                    const savedBody = localStorage.getItem('fitscan_body_data');
                    if (savedBody) {
                        this.currentBodyResult = JSON.parse(savedBody);
                        this.isReturningUser = true;
                    }
                },

                // --- AUTH LOGIC ---
                openAuth(mode) {
                    this.authMode = mode;
                    this.showAuthModal = true;
                    this.mobileMenu = false;
                },

                login() {
                    // Demo Login: Asal isi email & password dianggap sukses
                    if(this.loginEmail && this.loginPass) {
                        // Cek apakah ada data tersimpan di "backend" simulasi
                        // Untuk demo ini, kita anggap user "Budi" login jika belum ada data
                        this.currentUser = {
                            name: 'User Demo',
                            email: this.loginEmail,
                            tier: 'Free' // Default tier
                        };
                        this.saveUser();
                        this.isLoggedIn = true;
                        this.showAuthModal = false;
                        this.resetForms();
                    }
                },

                register() {
                    // Demo Register
                    if(this.regName && this.regEmail && this.regPass) {
                        this.currentUser = {
                            name: this.regName,
                            email: this.regEmail,
                            tier: 'Free' // Default Free Tier
                        };
                        this.saveUser();
                        this.isLoggedIn = true;
                        this.showAuthModal = false;
                        this.resetForms();
                    }
                },

                logout() {
                    this.isLoggedIn = false;
                    this.currentUser = null;
                    localStorage.removeItem('fitscan_user');
                    this.mobileMenu = false;
                },

                saveUser() {
                    localStorage.setItem('fitscan_user', JSON.stringify(this.currentUser));
                },

                resetForms() {
                    this.loginEmail = '';
                    this.loginPass = '';
                    this.regName = '';
                    this.regEmail = '';
                    this.regPass = '';
                },

                // --- PAYMENT LOGIC ---
                startPayment() {
                    if(!this.isLoggedIn) {
                        this.openAuth('login');
                        return;
                    }
                    this.showPaymentModal = true;
                    this.paymentStep = 1;
                },

                processPayment() {
                    this.paymentStep = 3; // Processing
                    // Simulasi loading 2.5 detik
                    setTimeout(() => {
                        this.paymentStep = 4; // Success
                        
                        // Upgrade Tier User
                        if(this.currentUser) {
                            this.currentUser.tier = 'Premium';
                            this.saveUser();
                        }
                    }, 2500);
                },

                closePayment() {
                    this.showPaymentModal = false;
                    setTimeout(() => this.paymentStep = 1, 300);
                },

                contactSales() {
                    const phoneNumber = "6285739588337";
                    const message = "Halo Tim FitScan, saya tertarik dengan paket FitScan Pro untuk Gym/PT. Mohon infonya.";
                    const url = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
                    window.open(url, '_blank');
                },

                // --- SCANNER LOGIC ---
                async startScan(mode) {
                    // Proteksi Fitur: Harus Login Dulu
                    if (!this.isLoggedIn) {
                        this.openAuth('login');
                        return;
                    }

                    this.scanMode = mode;
                    this.mobileMenu = false;
                    this.isScanning = true;
                    this.showResults = false;
                    this.scanStatus = 'MENGHUBUNGKAN KAMERA...';
                    this.cameraError = false;

                    const facingMode = mode === 'food' ? 'environment' : 'user';

                    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                        try {
                            const stream = await navigator.mediaDevices.getUserMedia({
                                video: { facingMode: facingMode },
                                audio: false
                            });
                            this.stream = stream;
                            this.$refs.video.srcObject = stream;
                            this.runScanSequence();
                        } catch (err) {
                            console.log("Camera fail, fallback mode");
                            this.handleCameraError();
                        }
                    } else {
                        this.handleCameraError();
                    }
                },

                handleCameraError() {
                    this.cameraError = true;
                    this.scanStatus = 'SIMULASI AI...';
                    this.runScanSequence();
                },

                runScanSequence() {
                    const steps = [
                        { time: 1000, text: this.scanMode === 'food' ? 'MENDETEKSI OBJEK...' : 'MENDETEKSI WAJAH & TUBUH...' },
                        { time: 2500, text: this.scanMode === 'food' ? 'MENGHITUNG KALORI...' : 'IDENTIFIKASI BIOMETRIK...' },
                        { time: 4000, text: 'FINALISASI DATA...' },
                        { time: 5000, action: 'finish' }
                    ];

                    let currentStep = 0;
                    const nextStep = () => {
                        if (currentStep >= steps.length) return;
                        const step = steps[currentStep];
                        setTimeout(() => {
                            if (step.action === 'finish') {
                                this.finishScan();
                            } else {
                                this.scanStatus = step.text;
                                currentStep++;
                                nextStep();
                            }
                        }, step.time - (currentStep > 0 ? steps[currentStep-1].time : 0));
                    };
                    nextStep();
                },

                finishScan() {
                    this.stopCamera();
                    
                    if (this.scanMode === 'food') {
                        const randomIndex = Math.floor(Math.random() * this.foodDatabase.length);
                        this.currentFoodResult = this.foodDatabase[randomIndex];
                    } 
                    else if (this.scanMode === 'body') {
                        const savedBody = localStorage.getItem('fitscan_body_data');
                        
                        if (savedBody) {
                            this.currentBodyResult = JSON.parse(savedBody);
                            this.isReturningUser = true;
                        } else {
                            const newBodyData = {
                                score: Math.floor(Math.random() * (95 - 65) + 65),
                                fat: (Math.random() * (25 - 10) + 10).toFixed(1),
                                muscle: (Math.random() * (65 - 45) + 45).toFixed(1)
                            };
                            this.currentBodyResult = newBodyData;
                            localStorage.setItem('fitscan_body_data', JSON.stringify(newBodyData));
                            this.isReturningUser = false;
                            setTimeout(() => { this.isReturningUser = true; }, 1000);
                        }
                    }

                    this.isScanning = false;
                    setTimeout(() => {
                        this.showResults = true;
                    }, 300);
                },

                resetBodyData() {
                    localStorage.removeItem('fitscan_body_data');
                    this.isReturningUser = false;
                    this.closeResults();
                    setTimeout(() => {
                        this.startScan('body');
                    }, 500);
                },

                stopCamera() {
                    if (this.stream) {
                        this.stream.getTracks().forEach(track => track.stop());
                        this.stream = null;
                    }
                    if (this.$refs.video) {
                        this.$refs.video.srcObject = null;
                    }
                },

                stopScan() {
                    this.stopCamera();
                    this.isScanning = false;
                },

                closeResults() {
                    this.showResults = false;
                }
            }
        }
    </script>
</body>
</html>
